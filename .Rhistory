rownames(Q2.tbl.am)[3] <- "계"
pander(Q2.tbl.am[-3, ])
pander(round(prop.table(Q2.tbl.am, margin = 1)[3,]*100, digits=1))
Q3.tbl.am <- addmargins(table(quiz1102$group, quiz1102$Q3, exclude = NULL), margin = 1)
colnames(Q3.tbl.am)[5] <- "결석"
rownames(Q3.tbl.am)[4] <- "계"
rownames(Q3.tbl.am)[3] <- "계"
pander(Q3.tbl.am[-3, ])
pander(round(prop.table(Q3.tbl.am, margin = 1)[4,]*100, digits = 1))
pander(round(prop.table(Q3.tbl.am, margin = 1)[3, ] * 100, digits = 1))
Q4.tbl.am <- addmargins(table(quiz1102$group, quiz1102$Q4, exclude = NULL), margin = 1)
colnames(Q4.tbl.am)[6] <- "결석"
rownames(Q4.tbl.am)[3] <- "계"
pander(Q4.tbl.am[-3, ])
pander(round(prop.table(Q4.tbl.am[, -6], margin = 1)[-(3:4), ]*100, digits = 1))
knitr::opts_chunk$set(echo = TRUE)
# install.packages("pander", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width = 180)
tapply((result.df$총점, result.df$팀, sum)
tapply((result.df$"총점", result.df$"팀", sum)
tapply(result.df$"총점", result.df$"팀", sum)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("pander", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width = 180)
tapply(result.df$"총점", result.df$"팀", sum)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("pander", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width = 180)
quiz1128 <- read.xlsx("../data/quiz1128.xlsx",
sheetIndex = 1,
startRow = 2,
endRow = 97,
colIndex = c(3:7, 9:20),
colClasses = rep("character", 17),
header = TRUE,
stringsAsFactors = FALSE)
quiz1128 <- read.xlsx("../data/quiz1128.xlsx",
sheetIndex = 1,
startRow = 2,
endRow = 97,
colIndex = c(3:7, 9:20),
colClasses = rep("character", 17),
header = TRUE,
stringsAsFactors = FALSE)
# str(quiz1128)
names(quiz1128) <- c("dept", "id", "name", "year", "e.mail", "cell.no", "Team",
paste("Q", 1:10,
sep = ""))
quiz1128$dept <- factor(quiz1128$dept)
quiz1128$year <- factor(quiz1128$year)
Team <- quiz1128$Team
team.names <- unique(Team)
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# str(quiz1128)
names(quiz1128) <- c("dept", "id", "name", "year", "e.mail", "cell.no", "Team",
paste("Q", 1:10,
sep = ""))
quiz1128$dept <- factor(quiz1128$dept)
quiz1128$year <- factor(quiz1128$year)
Team <- quiz1128$Team
team.names <- unique(Team)
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
quiz1128$year <- factor(quiz1128$year)
Team <- quiz1128$Team
team.names <- unique(Team)
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
id.name <- NULL
quiz1128 <- read.xlsx("../data/quiz1128.xlsx",
sheetIndex = 1,
startRow = 2,
endRow = 97,
colIndex = c(3:7, 9:20),
colClasses = rep("character", 17),
header = TRUE,
stringsAsFactors = FALSE)
# str(quiz1128)
names(quiz1128) <- c("dept", "id", "name", "year", "e.mail", "cell.no", "Team",
paste("Q", 1:10,
sep = ""))
quiz1128$dept <- factor(quiz1128$dept)
quiz1128$year <- factor(quiz1128$year)
Team <- quiz1128$Team
team.names <- unique(Team)
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
id.name <- NULL
for(x in team.names.2) {
id.name <- rbind(id.name,
quiz1128.2[Team.2 == x,
c("id", "name")])
}
for(x in team.names.2) {
id.name <- rbind(id.name,
quiz1128.2[Team.2 == x,
c("id", "name")])
}
result.df <- data.frame(id.name,
Team = rownames(score.coll),
score.coll)
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
id.name <- NULL
for(x in team.names.2) {
id.name <- rbind(id.name,
quiz1128.2[Team.2 == x,
c("id", "name")])
}
result.df <- data.frame(id.name,
Team = rownames(score.coll),
score.coll)
result.df$sum <- rowSums(result.df[, 4:13])
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
id.name <- NULL
for(x in team.names.2) {
id.name <- rbind(id.name,
quiz1128.2[Team.2 == x,
c("id", "name")])
}
result.df <- data.frame(id.name,
Team = rownames(score.coll),
score.coll)
result.df$sum <- rowSums(result.df[, 4:13])
names(result.df) <- c("학번", "이름", "팀",
paste(1:10, "회차",
sep = ""), "총점")
tapply(result.df$"총점", result.df$"팀", sum)
str(tapply(result.df$"총점", result.df$"팀", sum))
which(tapply(result.df$"총점", result.df$"팀", sum)) == 60)
which(tapply(result.df$"총점", result.df$"팀", sum) == 60)
names(tapply(result.df$"총점", result.df$"팀", sum) == 60)
names(which(tapply(result.df$"총점", result.df$"팀", sum) == 60))
team_scores <- tapply(result.df$"총점", result.df$"팀", sum)
good_names <- names(which(team_scores >= 48))
best_names <- names(which(team_scores == 60)
team_scores <- tapply(result.df$"총점", result.df$"팀", sum)
good_names <- names(which(team_scores >= 48))
best_names <- names(which(team_scores == 60))
worst_names <- names(which(team_scores <= -30))
kable(result.df)
#> Team scores higher than 48
kable(result.df[result.df$"팀" %in% good_names, ])
#> Best team scores
kable(result.df[result.df$"팀" %in% best_names, ])
install.packages(c("data.table", "earth", "GA", "gdistance", "ggrepel", "httpuv", "modelr", "polyclip", "processx", "rgdal", "sf", "stringr"))
install.packages("xlsx")
install.packages("pander")
knitr::opts_chunk$set(echo = TRUE)
# install.packages("pander", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width = 180)
quiz1116 <- read.xlsx("../data/quiz1116.xlsx", 1, startRow = 2, endRow = 97, colIndex = c(3:7, 9:14), colClasses = c(rep("character", 11)), stringsAsFactors = FALSE)
str(quiz1116)
names(quiz1116) <- c("dept", "id", "name", "year", "e.mail", "cell.no", "Q1", "Q2", "Q3", "Q4", "group")
quiz1116$dept <- factor(quiz1116$dept)
quiz1116$year <- factor(quiz1116$year)
quiz1116$group <- factor(quiz1116$group, levels = c("Red", "Black"))
birth_month.date <- strsplit(quiz1116$Q1, ",")
birth_month <- mapply(function(x) x[1], birth_month.date)
birth_month.f <- factor(birth_month, levels = c(1:12, "조퇴"), labels = c(month.name, "조퇴"))
# birth_month.f <- factor(birth_month, levels = 1:12, labels = month.name)
# birth_month <- mapply(function(x) `[`(x, 1), birth_month.date)
table(birth_month.f)
birthdate <- ifelse(birth_month.date == "조퇴", "조퇴", ifelse(is.na(birth_month.date), NA, mapply(function(x) paste(x[1], "월", x[2], "일", sep = ""), birth_month.date)))
# birthdate <- ifelse(is.na(birth_month.date), NA, mapply(function(x) paste(x[1], "월", x[2], "일", sep = ""), birth_month.date))
quiz1116$Q1.2 <- birthdate
nr.index <- which(birthdate == "조퇴")
na.index <- which(is.na(birthdate))
u.nr.na <- union(nr.index, na.index)
birthdate.2 <- birthdate[setdiff(1:nrow(quiz1116), u.nr.na)]
# birthdate.2 <- birthdate[!is.na(birthdate)]
dup.b <- duplicated(birthdate.2)
birthdate.2[dup.b]
(b.dup.b <- birthdate.2[birthdate.2 %in% unique(birthdate.2[dup.b])])
index.dup.b <- which(birthdate %in% unique(b.dup.b))
quiz1116[index.dup.b, c("id", "Q1.2")]
matching <- strsplit(quiz1116$Q2, "")
ans <- strsplit("CNGA", split = "")
matching.count <- mapply(function(x) ifelse(x == unlist(ans), 1, 0), matching)
matching.score <- apply(matching.count, 2, sum)
quiz1116$Q2.2 <- matching.score
Black <- quiz1116$group == "Black"
Red <- quiz1116$group == "Red"
# quiz1116$Q4.2[quiz1116$group == "Black" & quiz1116$Q4 == "가"] <- "400명은 죽는다"
# quiz1116$Q4.2[quiz1116$group == "Black" & quiz1116$Q4 == "나"] <- "모두 사망 않을 확률 1/3"
# quiz1116$Q4.2[quiz1116$group == "Red" & quiz1116$Q4 == "가"] <- "200명은 살린다"
# quiz1116$Q4.2[quiz1116$group == "Red" & quiz1116$Q4 == "나"] <- "모두 살릴 확률 1/3"
# quiz1116$Q4.2 <- quiz1116$Q4
quiz1116$Q3.2[Red] <- ifelse(quiz1116$Q3[Red] == "가", "실업률10%(취업률90%), 인플레12%", ifelse(quiz1116$Q3[Red] == "나", "실업률5%(취업률95%), 인플레17%", NA))
quiz1116$Q3.2[Black] <- ifelse(quiz1116$Q3[Black] == "가", "실업률10%(취업률90%), 인플레12%", ifelse(quiz1116$Q3[Black] == "나", "실업률5%(취업률95%), 인플레17%", NA))
quiz1116$Q3.2 <- factor(quiz1116$Q3.2, levels = c("실업률10%(취업률90%), 인플레12%", "실업률5%(취업률95%), 인플레17%"))
quiz1116$Q4.2[Red] <- ifelse(quiz1116$Q4[Red] == "가", "수용가능", ifelse(quiz1116$Q4[Red] == "나", "불공정", NA))
quiz1116$Q4.2[Black] <- ifelse(quiz1116$Q4[Black] == "가", "수용가능", ifelse(quiz1116$Q4[Black] == "나", "불공정", NA))
quiz1116$Q4.2 <- factor(quiz1116$Q4.2, levels = c("수용가능", "불공정"))
# str(quiz1116)
pander(quiz1116[c("Q3", "Q3.2", "Q4", "Q4.2", "group")])
tbl.dup.b <- table(b.dup.b)
tbl.dup.b.a <- addmargins(tbl.dup.b)
names(tbl.dup.b.a)[11] <- "계"
pander(tbl.dup.b.a)
birth_month.tbl <- table(quiz1116$group, "태어난 달" = birth_month.f)
birth_month.tbl.a <- addmargins(birth_month.tbl)
rownames(birth_month.tbl.a)[3] <- "계"
colnames(birth_month.tbl.a)[14] <- "계"
pander(birth_month.tbl.a)
matching.score.tbl <- table(quiz1116$group, "맞춘 갯수" = matching.score)
matching.score.tbl.a <- addmargins(matching.score.tbl)
rownames(matching.score.tbl.a)[3] <- "계"
colnames(matching.score.tbl.a)[5] <- "계"
pander(matching.score.tbl.a)
pander(chisq.test(table(matching.score), p = c(9, 8, 6, 1)/24, simulate.p.value = TRUE, B = 2000))
tbl.q3 <- table(quiz1116$group, quiz1116$Q3.2, useNA = "ifany")
rownames(tbl.q3) <- c("Red(실업률 관점)", "Black(취업률 관점)", "NA")
tbl.q3
