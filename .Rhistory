score.coll
sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
sample.coll
records[Team.2 == "지니", -1]
rownames(records[Team.2 == "지니", -1])
records[c(51, 95),]
records
setwd("~/Google 드라이브/Works/Class/Statistics/R.WD/Class_data/class201602/R")
library(xlsx)
library(knitr)
library(pander)
panderOptions("table.split.table", Inf)
total <- read.xlsx(file = "../data/scoreList.xlsx", sheetIndex = 1, rowIndex = 3:98, colIndex = 2:8, colClasses = c(rep("character", 2), rep("numeric", 5)), header = TRUE)
total <- total[c(2, 1, 4:7, 3)]
total <- total[c(2, 1, 7, 5, 4, 6, 3)]
v.names.total <- c("ID", "Name", "Offline", "Online", "Assignment", "Facebook", "Total")
names(total) <- v.names.total
N <- nrow(total)
total$Ranks <- N + 1 - rank(total$Total)
total$Grades <- ifelse(total$Ranks <= floor(N*0.3), "A+", ifelse(total$Ranks <= floor(N*0.6), "B+", "C+"))
kable(total)
total <- read.xlsx(file = "../data/scoreList.xlsx", sheetIndex = 1, rowIndex = 3:98, colIndex = 2:8, colClasses = c(rep("character", 2), rep("numeric", 5)), header = TRUE)
total <- total[c(2, 1, 7, 5, 4, 6, 3)]
v.names.total <- c("ID", "Name", "Offline", "Online", "Assignment", "Facebook", "Total")
names(total) <- v.names.total
N <- nrow(total)
total$Ranks <- N + 1 - rank(total$Total)
total$Grades <- ifelse(total$Ranks <= floor(N*0.3), "A+", ifelse(total$Ranks <= floor(N*0.6), "B+", "C+"))
kable(total)
95*0.3
95*0.6
95*0.6
21*.4
72*0.6
install.packages("xlsx")
install.packages("xlsxjars")
knitr::opts_chunk$set(echo = TRUE)
# install.packages("pander", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width = 180)
quiz1102 <- read.xlsx("../data/quiz1102.xlsx", 1, startRow = 2, endRow = 97, colIndex = c(3:7, 9:14), colClasses = c(rep("character", 11)), stringsAsFactors = FALSE)
str(quiz1102)
names(quiz1102) <- c("dept", "id", "name", "year", "e.mail", "cell.no", "Q1", "Q2", "Q3", "Q4", "group")
quiz1102$dept <- factor(quiz1102$dept)
quiz1102$year <- factor(quiz1102$year)
quiz1102$group <- factor(quiz1102$group, levels = c("Red", "Black"))
quiz1102$Q1 <- factor(quiz1102$Q1, levels = c("가", "나", "다", "라"), labels = c("생산성 향상 < 임금 향상", "고소득층 소득 > 중산층 이하 소득", "중산층 이하 소득 > 고소득층 소득", "평균 임금 증가율 < 중위 임금 증가율"))
quiz1102$Q2 <- factor(quiz1102$Q2, levels = c("가", "나", "다", "라"), labels = c("10억", "20억", "25억", "30억"))
quiz1102$Q3 <- factor(quiz1102$Q3, levels = c("가", "나", "다", "라"), labels = c("100%", "75%", "50%", "25%"))
quiz1102$Q4 <- factor(quiz1102$Q4, levels = c("가", "나", "다", "라", "ㅁㅏ"), labels = c("무상", "100만원", "200만원", "500만원", "1,000만원"))
# quiz1102$Q4.2[quiz1102$group == "Black" & quiz1102$Q4.2 == "나"] <- "하야"
# quiz1102$Q4.2[quiz1102$group == "Black" & quiz1102$Q4.2 == "다"] <- "탄핵"
# quiz1102$Q4.2[quiz1102$group == "Black" & quiz1102$Q4.2 == "라"] <- "모르겠다"
# quiz1102$Q4.2[quiz1102$group == "Black" & quiz1102$Q4.2 == "조퇴"] <- "조퇴"
# quiz1102$Q4.2[quiz1102$group == "Red" & quiz1102$Q4.2 == "가"] <- "탄핵"
# quiz1102$Q4.2[quiz1102$group == "Red" & quiz1102$Q4.2 == "나"] <- "하야"
# quiz1102$Q4.2[quiz1102$group == "Red" & quiz1102$Q4.2 == "다"] <- "아니다"
# quiz1102$Q4.2[quiz1102$group == "Red" & quiz1102$Q4.2 == "라"] <- "모르겠다"
# quiz1102$Q4.2[quiz1102$group == "Red" & quiz1102$Q4.2 == "조퇴"] <- "조퇴"
# quiz1102$Q4.2 <- factor(quiz1102$Q4.2, levels = c("탄핵", "하야", "아니다", "모르겠다", "조퇴"))
str(quiz1102)
Q1.tbl.am <- addmargins(table(quiz1102$group, quiz1102$Q1, exclude = NULL), margin = 1)
colnames(Q1.tbl.am)[5] <- "결석"
rownames(Q1.tbl.am)[4] <- "계"
rownames(Q1.tbl.am)[3] <- "계"
pander(Q1.tbl.am[-3, ])
pander(round(prop.table(Q1.tbl.am, margin = 1)[4, ]*100, digits = 1))
pander(round(prop.table(Q1.tbl.am, margin = 1)[3, ]*100, digits = 1))
Q2.tbl.am <- addmargins(table(quiz1102$group, quiz1102$Q2, exclude = NULL), margin = 1)
colnames(Q2.tbl.am)[5] <- "결석"
rownames(Q2.tbl.am)[3] <- "계"
pander(Q2.tbl.am[-3, ])
pander(round(prop.table(Q2.tbl.am, margin = 1)[3,]*100, digits=1))
Q3.tbl.am <- addmargins(table(quiz1102$group, quiz1102$Q3, exclude = NULL), margin = 1)
colnames(Q3.tbl.am)[5] <- "결석"
rownames(Q3.tbl.am)[4] <- "계"
rownames(Q3.tbl.am)[3] <- "계"
pander(Q3.tbl.am[-3, ])
pander(round(prop.table(Q3.tbl.am, margin = 1)[4,]*100, digits = 1))
pander(round(prop.table(Q3.tbl.am, margin = 1)[3, ] * 100, digits = 1))
Q4.tbl.am <- addmargins(table(quiz1102$group, quiz1102$Q4, exclude = NULL), margin = 1)
colnames(Q4.tbl.am)[6] <- "결석"
rownames(Q4.tbl.am)[3] <- "계"
pander(Q4.tbl.am[-3, ])
pander(round(prop.table(Q4.tbl.am[, -6], margin = 1)[-(3:4), ]*100, digits = 1))
knitr::opts_chunk$set(echo = TRUE)
# install.packages("pander", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width = 180)
tapply((result.df$총점, result.df$팀, sum)
tapply((result.df$"총점", result.df$"팀", sum)
tapply(result.df$"총점", result.df$"팀", sum)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("pander", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width = 180)
tapply(result.df$"총점", result.df$"팀", sum)
knitr::opts_chunk$set(echo = TRUE)
# install.packages("pander", repos = "https://cran.rstudio.com")
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(pander)
library(knitr)
panderOptions('table.split.table', Inf)
panderOptions('table.alignment.rownames', 'left')
panderOptions('table.alignment.default', 'right')
options(width = 180)
quiz1128 <- read.xlsx("../data/quiz1128.xlsx",
sheetIndex = 1,
startRow = 2,
endRow = 97,
colIndex = c(3:7, 9:20),
colClasses = rep("character", 17),
header = TRUE,
stringsAsFactors = FALSE)
quiz1128 <- read.xlsx("../data/quiz1128.xlsx",
sheetIndex = 1,
startRow = 2,
endRow = 97,
colIndex = c(3:7, 9:20),
colClasses = rep("character", 17),
header = TRUE,
stringsAsFactors = FALSE)
# str(quiz1128)
names(quiz1128) <- c("dept", "id", "name", "year", "e.mail", "cell.no", "Team",
paste("Q", 1:10,
sep = ""))
quiz1128$dept <- factor(quiz1128$dept)
quiz1128$year <- factor(quiz1128$year)
Team <- quiz1128$Team
team.names <- unique(Team)
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# str(quiz1128)
names(quiz1128) <- c("dept", "id", "name", "year", "e.mail", "cell.no", "Team",
paste("Q", 1:10,
sep = ""))
quiz1128$dept <- factor(quiz1128$dept)
quiz1128$year <- factor(quiz1128$year)
Team <- quiz1128$Team
team.names <- unique(Team)
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
quiz1128$year <- factor(quiz1128$year)
Team <- quiz1128$Team
team.names <- unique(Team)
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
id.name <- NULL
quiz1128 <- read.xlsx("../data/quiz1128.xlsx",
sheetIndex = 1,
startRow = 2,
endRow = 97,
colIndex = c(3:7, 9:20),
colClasses = rep("character", 17),
header = TRUE,
stringsAsFactors = FALSE)
# str(quiz1128)
names(quiz1128) <- c("dept", "id", "name", "year", "e.mail", "cell.no", "Team",
paste("Q", 1:10,
sep = ""))
quiz1128$dept <- factor(quiz1128$dept)
quiz1128$year <- factor(quiz1128$year)
Team <- quiz1128$Team
team.names <- unique(Team)
na.index <- which(is.na(Team))
quiz1128.2 <- quiz1128[-na.index, ]
Team.2 <- quiz1128.2$Team
team.names.2 <- unique(Team.2)
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
id.name <- NULL
for(x in team.names.2) {
id.name <- rbind(id.name,
quiz1128.2[Team.2 == x,
c("id", "name")])
}
for(x in team.names.2) {
id.name <- rbind(id.name,
quiz1128.2[Team.2 == x,
c("id", "name")])
}
result.df <- data.frame(id.name,
Team = rownames(score.coll),
score.coll)
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
id.name <- NULL
for(x in team.names.2) {
id.name <- rbind(id.name,
quiz1128.2[Team.2 == x,
c("id", "name")])
}
result.df <- data.frame(id.name,
Team = rownames(score.coll),
score.coll)
result.df$sum <- rowSums(result.df[, 4:13])
records <- quiz1128.2[, 7:17]
kable(quiz1128.2[, c("id", "name","Team",
paste("Q", 1:10,
sep = ""))])
# sample.coll <- sapply(records[Team.2 == "지니", -1], paste, collapse = "")
score <- function(x) {
switch(x,
MM = c(-3, -3),
MW = c(6, -6),
WM = c(-6, 6),
WW = c(3, 3))
}
# sapply(sample.coll, score)
records.coll <- NULL
for(x in team.names.2) {
records.coll <- rbind(records.coll,
sapply(records[Team.2 == x, -1],
paste,
collapse = ""))
}
rownames(records.coll) <- team.names.2
kable(records.coll)
score.coll <- NULL
for(x in team.names.2) {
score.coll <- rbind(score.coll, sapply(records.coll[rownames(records.coll) == x, ], score))
}
# kable(score.coll)
rownames(score.coll) <- rep(rownames(records.coll), each = 2)
kable(score.coll)
id.name <- NULL
for(x in team.names.2) {
id.name <- rbind(id.name,
quiz1128.2[Team.2 == x,
c("id", "name")])
}
result.df <- data.frame(id.name,
Team = rownames(score.coll),
score.coll)
result.df$sum <- rowSums(result.df[, 4:13])
names(result.df) <- c("학번", "이름", "팀",
paste(1:10, "회차",
sep = ""), "총점")
tapply(result.df$"총점", result.df$"팀", sum)
str(tapply(result.df$"총점", result.df$"팀", sum))
which(tapply(result.df$"총점", result.df$"팀", sum)) == 60)
which(tapply(result.df$"총점", result.df$"팀", sum) == 60)
names(tapply(result.df$"총점", result.df$"팀", sum) == 60)
names(which(tapply(result.df$"총점", result.df$"팀", sum) == 60))
team_scores <- tapply(result.df$"총점", result.df$"팀", sum)
good_names <- names(which(team_scores >= 48))
best_names <- names(which(team_scores == 60)
team_scores <- tapply(result.df$"총점", result.df$"팀", sum)
good_names <- names(which(team_scores >= 48))
best_names <- names(which(team_scores == 60))
worst_names <- names(which(team_scores <= -30))
kable(result.df)
#> Team scores higher than 48
kable(result.df[result.df$"팀" %in% good_names, ])
#> Best team scores
kable(result.df[result.df$"팀" %in% best_names, ])
